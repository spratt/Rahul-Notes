\documentclass[letterpaper,12pt,twocolumn]{article}

\usepackage{savetrees}
\usepackage{xspace}
\usepackage[inline]{enumitem}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsmath}

\DeclareMathOperator{\splt}{split}
\DeclareMathOperator{\range}{range}

\newcommand\etal{\textit{et al.}\xspace}

\newcommand{\BigOh}[1]{O\!\left(#1\right)}
\newcommand\IR{\mathbb{R}}
\newcommand\D[1]{$D_{#1}$}
\newcommand\bounds[1]{[#1]}
\newcommand\lbounds[1]{(#1]} %chktex 9
\newcommand\rbounds[1]{[#1)} %chktex 9
\newcommand\lrbounds[1]{(#1)}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}

\begin{document}

{\noindent\Large 5-Sided Orthogonal Point Enclosure}\\
{\noindent Notes on Rahul 2015, by Simon Pratt}

The primary intention of these notes is to answer: how
does~\cite{saladi2015improved} answer 3D 5-sided point enclosure
queries?

\paragraph{Orthogonal Point Enclosure Queries (OPEQ)}
Preprocess a set $S$ of $n$ axes-parallel rectangles in $\IR^3$ in
order to determine all rectangles containing a query point $q$.  In
particular, we wish to consider the case in which a rectangle is
5-sided.  To be precise, our rectangles are of the form
$\bounds{x_1,x_2} \times \bounds{y_1, y_2} \times
\lbounds{-\infty,z}$.  In these notes, we will prove the following:

\begin{theorem}[5.1 in~\cite{saladi2015improved}]\label{thm:51}

  OPEQ on 5-sided rectangles can be answered using a structure of
  $\BigOh{n\log^* n}$ size and $\BigOh{\log n \log\log n + k}$ query
  time, where $k$ is the size of the output.

\end{theorem}

\section{Simple and Slow in Linear Space}

In this section, we will prove the following:

\begin{theorem}[2.1 in~\cite{saladi2015improved}]\label{thm:21}

  OPEQ on 5-sided rectangles can be answered using a structure of
  $\BigOh{n}$ size and $\BigOh{\log^3 n + k}$ query time, where $k$
  is the size of the output.

\end{theorem}

An \emph{interval tree} is a binary tree whose leaves store the values
of the endpoints of a set of intervals~\cite{edelsbrunner1983new}.  At
each node $v$, store $\splt(v)$ which is the largest value in the left
subtree of $v$, and $\range(v)$ which is $(-\infty,\infty)$ at the
root, and otherwise if $\range(v) = [x_\ell, x_r]$, then $v$'s left
child will have range $[x_\ell, \splt(v)]$, and symmetrically for the
right child.  An interval is stored at the node $v$ of minimal height
such that the interval is contained within $\range(v)$.  If we
additionally maintain lists that store the left/right endpoints of all
intervals stored at $v$ in non-decreasing/non-increasing order, then
space remains $\BigOh{n}$, but we can answer a 1D OPEQ in $\BigOh{\log
  n + k}$ time.

Note that 3D 3-sided OPEQ can been solved using $\BigOh{n}$ space in
$\BigOh{\log n + k}$ query time by reduction to 3D dominance
reporting~\cite{afshani2008dominance,makris2012improved}.  Call this
structure \D{3}.

Given a set of 4-sided rectangles of the form $\bounds{x_1,x_2} \times
\lbounds{-\infty, y} \times \lbounds{-\infty,z}$, we can build an
interval tree of all rectangles' projection onto the $x$-axis.
Observe that at node $v$, if the query point $q$ is to the left of
$\splt(v)$ then for each rectangle $r$ stored at $v$, $r$ contains $q$
iff $q \in \rbounds{x_1, \infty} \times \lbounds{\infty, y} \times
\lbounds{\infty, z}$, and similarly (but symmetrically) if $q$ is to
the right of $\splt(v)$.  This effectively reduces the problem to a
3-sided query, for which we can store \D{3} at each node.  Since we
perform at most $\BigOh{\log n}$ of these queries (one at each level
of the interval tree), the total query time is $\BigOh{\log^2 n + k}$
and space is still $\BigOh{n}$.  Call this structure \D{4}.  We can
use the same technique to solve 5-sided queries in $\BigOh{\log^3 n +
  k}$ time by storing \D{4} structures at the nodes of this interval
tree instead.  This proves Theorem~\ref{thm:21}.

\section{Faster in Near-Linear Space}

When $k \ge \log^3 n$, then Theorem~\ref{thm:21} gives $\BigOh{k}$
query time.  Otherwise, we pre-compute partial answers to each query
using a grid technique adapted from~\cite{alstrup2000new} and the
following theorem:

\begin{theorem}[3.1 in~\cite{saladi2015improved}]\label{thm:31}

  OPEQ on 4-sided rectangles can be answered using a structure of
  $\BigOh{n\log^* n}$ size and $\BigOh{\log n \cdot \log^* n + k}$
  query time, where $k$ is the size of the output.

\end{theorem}

Given two points $p,q \in \IR^d$, then $p = (p_1, \ldots, p_d)$
\emph{dominates} $q = (q_1, \ldots, q_d)$ if $p_i > q_i$ for all $i
\in \{1, \ldots, d \}$.  Given a set of points $P$, $R$ is a
\emph{$t$-level shallow cutting} of $P$ if
%
\begin{enumerate*}[label=(\roman*)]
\item $|R| = \BigOh{n/t}$,
\item any point $p$ that is dominated by at most $t$ points of $P$
  dominates a point in $R$, and
\item each point in $R$ is dominated by $\BigOh{t}$ points in $P$.
\end{enumerate*}

Which concludes the proof of Theorem~\ref{thm:51}.

\bibliographystyle{alpha}
\bibliography{Saladi-Notes-References}

\end{document} %chktex 17
